@model FitnessWebAppModels.Exercise

@{
    ViewData["Title"] = "ShowExercise";
}
<style>
    body {
        background: #fafafa;
    }

    .widget-area.blank {
        background: none repeat scroll 0 0 rgba(0, 0, 0, 0);
        -webkit-box-shadow: none;
        -moz-box-shadow: none;
        -ms-box-shadow: none;
        -o-box-shadow: none;
        box-shadow: none;
    }

    body .no-padding {
        padding: 0;
    }

    .widget-area {
        background-color: #fff;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        -ms-border-radius: 4px;
        -o-border-radius: 4px;
        border-radius: 4px;
        -webkit-box-shadow: 0 0 16px rgba(0, 0, 0, 0.05);
        -moz-box-shadow: 0 0 16px rgba(0, 0, 0, 0.05);
        -ms-box-shadow: 0 0 16px rgba(0, 0, 0, 0.05);
        -o-box-shadow: 0 0 16px rgba(0, 0, 0, 0.05);
        box-shadow: 0 0 16px rgba(0, 0, 0, 0.05);
        float: left;
        margin-top: 30px;
        padding: 25px 30px;
        position: relative;
        width: 100%;
    }

    .status-upload {
        background: none repeat scroll 0 0 #f5f5f5;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        -ms-border-radius: 4px;
        -o-border-radius: 4px;
        border-radius: 4px;
        float: left;
        width: 100%;
    }

    .status-upload form {
        float: left;
        width: 100%;
    }

    .status-upload form textarea {
        background: none repeat scroll 0 0 #fff;
        border: medium none;
        -webkit-border-radius: 4px 4px 0 0;
        -moz-border-radius: 4px 4px 0 0;
        -ms-border-radius: 4px 4px 0 0;
        -o-border-radius: 4px 4px 0 0;
        border-radius: 4px 4px 0 0;
        color: #777777;
        float: left;
        font-family: Lato;
        font-size: 14px;
        height: 142px;
        letter-spacing: 0.3px;
        padding: 20px;
        width: 100%;
        resize: vertical;
        outline: none;
        border: 1px solid #F2F2F2;
    }

    .status-upload ul {
        float: left;
        list-style: none outside none;
        margin: 0;
        padding: 0 0 0 15px;
        width: auto;
    }

    .status-upload ul > li {
        float: left;
    }

    .status-upload ul > li > a {
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        -ms-border-radius: 4px;
        -o-border-radius: 4px;
        border-radius: 4px;
        color: #777777;
        float: left;
        font-size: 14px;
        height: 30px;
        line-height: 30px;
        margin: 10px 0 10px 10px;
        text-align: center;
        -webkit-transition: all 0.4s ease 0s;
        -moz-transition: all 0.4s ease 0s;
        -ms-transition: all 0.4s ease 0s;
        -o-transition: all 0.4s ease 0s;
        transition: all 0.4s ease 0s;
        width: 30px;
        cursor: pointer;
    }

    .status-upload ul > li > a:hover {
        background: none repeat scroll 0 0 #606060;
        color: #fff;
    }

    .status-upload form button {
        border: medium none;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        -ms-border-radius: 4px;
        -o-border-radius: 4px;
        border-radius: 4px;
        color: #fff;
        float: right;
        font-family: Lato;
        font-size: 14px;
        letter-spacing: 0.3px;
        margin-right: 9px;
        margin-top: 9px;
        padding: 6px 15px;
    }

    .dropdown > a > span.green:before {
        border-left-color: #2dcb73;
    }

    .status-upload form button > i {
        margin-right: 7px;
    }
</style>

<h2>@Html.DisplayFor(model => model.Name)</h2>
<div>
    <h4> @Html.DisplayNameFor(model => model.MuscleGroup)</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>
            Info:
        </dt>
        <dd>
            @Model.Description
        </dd>
    </dl>
    @if (User.Identity.IsAuthenticated)
    {
        //TODO post comment code here?
        <div class="container">
            <div class="row">
                <h3>Add comment</h3>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="widget-area no-padding blank">
                        <div class="status-upload">
                            <textarea id="Comment" placeholder="Post your comment here!"></textarea>
                            <button id="Postcomment" class="btn btn-success green"><i class="fa fa-share"></i> Place comment</button>
                        </div><!-- Status Upload  -->
                    </div><!-- Widget Area -->
                </div>
            </div>
        </div>
    }

    @if (Model.Comments.Count < 1)
    {
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <div class="page-header">
                        <h1><small class="pull-right">@Model.Comments.Count Comments</small> Comments </h1>
                    </div>
                    <div class="comments-list">
                        <div class="media">
                            @foreach (var comment in Model.Comments)
                            {
                                <div class="media-body col-xs-12">
                                    <h4 class="media-heading user_name">@comment.Nickname</h4>
                                    @comment.Text
                                    <p><small><a class="pull-right" href="#">Like</a></small></p>
                                </div>
                            }
                        </div>
                    </div>

                </div>
            </div>
        </div>
    }
</div>

@section Scripts {
    <script>
        $('#Postcomment').click(function() {
            if ($('#Comment').val().length < 3) {
                alert("Enter at least 3 tokens");
            } else {
                $.ajax({
                    url: '@Url.Action("AddCommentToWorkout","Comment")',
                    data: {
                        workoutId:@Model.Id,
                        text: $('#Comment').val()
                    },
                    type: "POST",
                    dataType: "json",
                    success: function(result) {
                        console.log("Successfully placed comment!");
                        alert(result.message);
                        location.reload(); 
                    },
                    error: function () {
                        alert("Adding comment failed");
                    }
                });
            }
        });
    </script>
}
